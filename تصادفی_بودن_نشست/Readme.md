#### تجزیه و تحلیل متغیر ‏ Session ID‏در صورت وجود باید برای ایجاد هر گونه الگوهای قابل‌تشخیص یا قابل‌پیش‌بینی انجام شود. این تحلیل‌ها ممکن است به صورت دستی و با ابزارهای آماری برای استنباط هر الگویی در محتوای  Session IDانجام شود. چک‌های دستی باید شامل مقایسه Session ID صادر شده برای شرایط ورود یک‌سان باشد به عنوان مثال، همان نام کاربری، رمز عبور و آدرس IP.
* زمان یک عامل مهم است که باید کنترل شود. برای جمع آوری نمونه ها در یک پنجره زمانی و ثابت نگه داشتن آن متغیر، باید تعداد زیادی اتصال همزمان ایجاد شود.
* عناصر متغیر باید در طول زمان تجزیه و تحلیل شوند تا مشخص شود که آیا افزایشی هستند یا خیر. هنگامی که آن‌ها افزایشی هستند، الگوهای مربوط به زمان مطلق یا سپری‌شده باید مورد بررسی قرار گیرند. بسیاری از سیستم‌ها از زمان به عنوان دانه برای عناصر شبه تصادفی خود استفاده می‌کنند. جایی که الگوها به نظر تصادفی می‌رسند، گام‌های زمانی یک طرفه یا دیگر تغییرات محیطی باید به عنوان یک احتمال در نظر گرفته شوند. 
* در تجزیه و تحلیل توالی‌های Session ID، الگوها یا چرخه‌ها، عناصر ایستا و …، همگی باید به عنوان عناصر سهیم احتمالی در ساختار و عملکرد برنامه در نظر گرفته شوند.

>آیا Session ID به طور قابل‌اثبات تصادفی است؟ آیا مقادیر حاصل شده می‌توانند باز تولید شوند؟
آیا شرایط ورودی مشابه همان ID را در اجرای بعدی تولید می‌کند؟
 آیا Session ID به طور قابل‌اثبات نسبت به تجزیه و تحلیل آماری یا رمزی مقاوم است؟
 کدام عناصر Session ID مربوط به زمان هستند؟
 چه بخش‌هایی از شناسه نشست قابل‌پیش‌بینی هستند؟
آیا می‌توان شناسه بعدی را با دانش کامل الگوریتم تولید وID های قبلی استنتاج کرد؟

#### Session ID ها را چگونه میتوان بدست آورد؟
> تا زمانی که وب اپلیکیشن‌ها از session ID برای تشخیص هویت استفاده می کنند، میتوان گفت که سرقت      session   در این سطح تماما منحصر به بدست آوردن session ID می‌شود. بدین معنی که زمانی که session ID  بدست آمد، می‌توان گفت که تقریبا کار تمام است و session ربایش شده استSession ID ها را معمولا در سه مکان می‌توان جستجو کرد :
* بصورت جاسازی شده در URL که از طریق درخواست‌های HTTP GET موقعی که کلاینت بر روی لینک‌های موجود در صفحه کلیک می‌کند، از سوی اپلیکیشن دریافت می‌شود.
* لا به لای فیلدهای یک فرم که به سمت وب اپلیکیشن ارسال می‌شود.
* از طریق استفاده از کوکی‌ها
> تمام این سه مکان توسط مهاجم قابل دسترس است.
##### اگر session ID طوری باشد  که بتوان با استفاده از الگویی، session های بعدی را حدس زد، مهاجم می‌تواند از طریق Brute force، آن‌ها را حدس بزند. این روش به این صورت است که مهاجم بر اساس الگویی خاص، تعداد زیادی session ID را حدس زده و تست خواهد کرد. این روش را براحتی می‌توان بصورت یک حمله اتوماتیک انجام داد و تا پیدا شدن یک session ID معتبر، ادامه خواهد داشت. در یک شرایط ایده‌آل، مهاجم می‌تواند session ID   را در ثانیه حدس بزند. بنابراین اگر الگوریتمی که session ID را می‌سازد، به حد کافی تصادفی و رندوم نباشد، مهاجم می‌تواند با استفاده از این روش بسرعت یک session ID قابل استفاده را حدس بزند.

* Session ID  قدرتمند
> نکته کلیدی در محافظت از وب اپلیکیشن در برابر دزدیده شدن session، پیاده‌سازی یک ساختار و الگوریتم قدرتمند در ایجاد session id است. مدیریت session چه بصورت client side باشد و چه بصورت server side، این موضوع هیچ فرقی نمی‌کند و در هر دو حالت صادق است. در ادامه تکنیک‌هایی بیان خواهد شد که به هر چه قوی‌تر شدن session Id در وب اپلیکیشن‌ها کمک شایانی خواهند کرد:

* افزایش طول کوکی یا session id
> طول session id باید به اندازه‌ای باشد که آن را در برابر حملات brute-force که صرفا به منظور حدس زدن و بدست آوردن session id معتبر است، محافظت کند. این افزایش طول باید طوری باشد که مهاجم تا زمانی که      session    منقضی نشده، نتواند حتی رنج و محدوده ای کهsession id ها بر اساس آن تولید می‌شوند را حدس بزند. بر اساس نوع پردازنده و میزان پهنای باندی که وجود دارد طول session id تعیین می‌شود. اما توصیه شده است که طول آن کمتر از 50 کاراکتر نباشد.

* تخصیص Session IDها را رندوم‌تر کنید
> ممکن است که ایجادsession id ها بصورت ترتیبی باشد و یا آن که  یک  indexبرای یک یوزر به عنوان       session id   در نظر گرفته شود که با تغییر کاربر، آن نیز تغییر کند. در این صورت براحتی می‌توان session id های معتبر را حدس زد. بنابراین توصیه می‌شود که ایجاد و تخصیص session id معتبر کاملا بصورت تصادفی و رندوم باشد. در این صورت مقدار بعدی session id را که توسط الگوریتم رندوم تولید می‌شود را بسختی می‌توان حدس زد.

* از یکپارچگی Session ID محافظت کنید
> به انتهای session id یک کد اصالت (هویتی) اضافه کنید تا بوسیله آن مطمئن شوید که session id دستکاری نشده است. در این روش درستی کد هویتی در هر درخواستی که سمت سرور میرود، چک خواهد شد. با انجام این کار دستکاری در کوکی‌ها و session id توسط مهاجم سخت‌تر خواهد شد. برای نمونه، این کدهای هویتی که می‌تواند مورد استفاده قرار گیرد شامل مقدار هش شده‌ی جمع مقادیرsession token های معتبر ( که توسط سرور ارسال می‌شوند)، آدرس IP کلاینت و یک برچسب زمانی کد شده از زمان استارت شدن session، هستند.

* استفاده از Session ID هایی که توسط سرور تامین می‌شوند
> بجای آنکه وب اپلیکیشن را مجبور به ایجادsession id های مخصوص به خودش کنید، می‌توانید برای این کار ازapplication server ای استفاده کنید که کارش بطور خاص تولید session id است. نمونه‌های چنینsession id هایی، ASPSESSIONID  و JSESSIONID هستند. اینsession id ها عموماsession id هایی هستند که نحوه تولیدشان طوری است که کمترین آسیب‌پذیری را در برابر session hijacking    دارند.

* از Session ID ها رمز شده استفاده کنید
> با رمز کردsession id ها می‌توان امنیت بیشتری را در قبال آن‌ها فراهم کرد. شما می‌توانید کدی را بنویسید که هرsession token ای را رمز کند و یا آن که کل session را با استفاده از ssl رمزنگاری کنید.

* بازه زمانی منقضی شدن Session
> یوزرها معمولا از سیستم‌های کلاینت مشترک استفاده می‌کنند. بنابراین این نکته مهم است که بعد از بازه زمانی مشخصی از آخرین فعالیت یوزر، session  آن بسته و نامعتبر شود. اگر چنین بازه زمانی برای session در نشر گرفته نشود، در واقع به مهاجم برای اجرای حمله Brute force و یا احیانا استفاده از session  دزدیده شده، بازه زمانی نامحدود داده‌ایم.

* تولید مجدد توکن
> راه دیگری که برای محدود کردن بازه زمانی که مهاجم حمله brute force را قبل از منقضی شدن session انجام می‌دهد، وجود دارد، تولید مجدد session token در بازه‌های کوتاهی از زمان است HTTP Server می‌تواند بطور یکپارچه، توکن‌ها را منقضی و مجددا تولید کند تا بدین وسیله مهاجم بازه زمانی بسیار کمی را برای اکسپلویت (سوء استفاده) کردن هر توکن معتبر داشته باشد.
