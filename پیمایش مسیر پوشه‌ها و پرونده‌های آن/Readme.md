### بنا به نیاز، برنامه‌های کاربردی تحت وِب، اغلب انواع مختلفی از ورودی‌ها را از کاربر دریافت می‌کنند. یکی از آن‌ها، ورودی‌های مربوط به مسیر یا نام یک پرونده است. در صورت عدم نظارت بر روی چنین ورودی‌هایی، کاربر می‌تواند به مسیر یا پرونده‌ای دیگر که خارج از محدودهٔ دسترسی اوست، دسترسی پیدا کند. بدین ترتیب، مورد محرمانگی نقض می‌شود. از آسیب‌پذیری‌های شایع در این قسمت، می‌توان به موارد زیر اشاره کرد:
1- [الحاق پرونده از راه دور](https://github.com/Fire-Null/Security-solutions/tree/main/%D9%BE%DB%8C%D9%85%D8%A7%DB%8C%D8%B4%20%D9%85%D8%B3%DB%8C%D8%B1%20%D9%BE%D9%88%D8%B4%D9%87%E2%80%8C%D9%87%D8%A7%20%D9%88%20%D9%BE%D8%B1%D9%88%D9%86%D8%AF%D9%87%E2%80%8C%D9%87%D8%A7%DB%8C%20%D8%A2%D9%86/LFI)

2- [الحاق پروندهٔ محلی](https://github.com/Fire-Null/Security-solutions/tree/main/%D9%BE%DB%8C%D9%85%D8%A7%DB%8C%D8%B4%20%D9%85%D8%B3%DB%8C%D8%B1%20%D9%BE%D9%88%D8%B4%D9%87%E2%80%8C%D9%87%D8%A7%20%D9%88%20%D9%BE%D8%B1%D9%88%D9%86%D8%AF%D9%87%E2%80%8C%D9%87%D8%A7%DB%8C%20%D8%A2%D9%86/RFI)




#### یک نمونه کد آسیپ‌پذیر  باگ LFI و RFI 

* همانطور که گفته شد این دو  باگ زمانی به وجود می‌آید  که برنامه‌نویس فایلی را اینکلود کند که آدرس آن را از کاربر دریافت کند  برای مثال به کد زیر توجه کنید :

```php
<?php
include ($_GET['file']);
?>
```
#### راه‌کار امن‌سازی ؟
* فایل وارد شده توسط کاربر را از یک لیست چک کنیم و اگر فایل در لیست بود اینکلود شود . مثال :
```php
<?php
$files=array('test.gif');
if(in_array($_GET['file'], $files)){
include ($_GET['file']);
}
?>
```
* یا در صورت دسترسی ادمین، allow_url_fopen را off  کنید یا با دستور ini_set این کار را انجام دهید،  فقط برای (RFI)
```php
<?php
ini_set('allow_url_fopen ', 'Off');
?>
```
* می‌توانید با استفاده از دستور strpos چک کنید که اگر در آدرس وارد شده http://  بود فایل اینکلود نشود )فقط می‌تواند جلوی RFI  را بگیرد (

```php
<?php
$strpos = strpos($_GET['url'],'http://');
if(!$strpos){
include($_GET['url']);
}
?>
```
* با استفاده از str_replace می‌توانید آدرس داده شده را از دو کارکتر “/” , “.” پاکسازی کنید .
```php
<?php
$url=$_GET['url'];
$url = str_replace("/", "", $url);
$url = str_replace(".", "", $url);
include($url);
?>
```
