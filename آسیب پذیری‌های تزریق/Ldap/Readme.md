#### (Lightweight Directory Access Protocol (LDAP پروتکلی است که برای فعال کردن جستجوی منابع (فایل ها، دستگاه ها یا کاربران) در یک شبکه طراحی شده است. این ابزار برای شبکه های اینترانت بسیار مفید است و وقتی در یک سیستم ورود گنجانده شود، می تواند نام های کاربری و رمز عبور را ذخیره کند. کوئری های LDAP از کاراکترهای کنترلی خاصی استفاده می کنند که بر عملکرد آن تأثیر می گذارد. اگر مهاجمان بتوانند کاراکترهای کنترلی را در یک کوئری LDAP وارد کنند، ممکن است رفتار مورد نظر را تغییر دهند. در حمله تزریق LDAP که نمونه ای از خطرناک ترین حملات تزریق می باشد، مهاجم ورودی مخربی را به برنامه تحت وب ارسال می کند که به درستی تایید نشده است. سپس می توان از این ورودی برای اصلاح یا دور زدن کوئری های LDAP استفاده شده توسط برنامه، احراز هویت کاربران یا دسترسی به خدمات دایرکتوری استفاده کرد.
> حملات تزریق LDAP می تواند منجر به خطراتی مختلفی شود، از جمله:
* به خطر انداختن داده‌های حساس ذخیره شده در دایرکتوری، مانند اعتبار کاربری یا سایر اطلاعات محرمانه
* به دست آوردن دسترسی غیرمجاز به سیستم یا برنامه
* اجرای کد دلخواه روی سرور

#### روش‌های پیشگیری 
* از کپی کردن داده‌هایی که کاربر وارد می‌نماید و کنترل آن‌ها توسط کاربر صورت می‌پذیرد در کوئر‌های LDAP خودداری نمایید. اگر این کار امکان پذیر نیست،  ورودی‌های کاربر به صورت بسیار دقیق و سختگیرانه‌ای توسط برنامه کاربردی ارزیابی گردد. در بسیاری از وضعیت‌ها، اگر به کاربر اجازه وارد کردن رشته‌های کوتاه الفبایی و عددی بر روی کوئری‌ها داده شود و مابقی ورودی‌هایش توسط برنامه کاربردی پذیرفته نشود از حملات تزریق LDAP جلوگیری خواهد شد. همچنین ورودی‌هایی که شامل متاکاراکترهای LDAP هستند مانند ( ) ; , * | & = نیز بایستی مسدود گردند، همچنین فضای سفید خالی (whitespace) نیز در دسته این ورودی‌ها قرار دارد.
> دلیل فراگیری این حملات عبارت است از:

1- استفاده از رابط‌های نامناسب و ناامن برای تولید و استفاده از پرس‌وجوهای LDAP

2- استفاده فراگیر از LDAP برای احراز هویت در اکثر سامانه‌های مدیریت متمرکز

#### راه حل جهت رفع تزریق پرس و جوهای LDAP

* اعتبارسنجی درست و موثر ورودیها پالایش (Filtering)  کاراکترهای کلیدی ( (), *, <=, >=, ~=, =, !, |, &) 

#### چطور از LDAP محافظت کنیم؟
> از آنجایی که LDAP ریسک‌های خودش را دارد،  در ادامه برخی از روش‌های محافظت از این پروتکل را مرور می‌کنیم.
* زمانی که ورودی سمت سرور اعتبارسنجی شود، می‌توان مطمئن بود همه ورودی‌ها از اعتبار کافی برای دسترسی برخوردارند.
* استفاده از مکانیزم فرار رشته‌های ورودی یک استراتژی ایمن‌سازی موثر برای این پروتکل است. چون ورودی‌های آسیب‌زا را به عنوان یک مقدار رشته‌ای پردازش می‌کند.
* اجرای استراتژی اصل حداقل امتیاز (POLP) به امنیت حساب LDAP کمک می‌کند.
