#### هدف حملات XXE برنامه های کاربردی وب است که ورودی XML را پردازش می کنند. آنها معمولاً به دلیل قدیمی بودن یا پیکربندی ضعیف پردازنده های XML رخ می دهند. با استفاده از این آسیب‌پذیری، هکرها می‌توانند به سیستم‌های بک‌اند و خارجی برای اجرای جعل درخواست‌های سمت سرور (SSRF) دسترسی داشته باشند.

#### روشهای جلوگیری از XXE

* غیرفعال کردن DTD این یکی از کارآمدترین راه ها برای جلوگیری از حملات XXE است. اگر غیرفعال کردن همه DTD ها غیرممکن است، لازم است هر DTD را طبق یک تجزیه کننده خاص غیرفعال کنید.
* برای از بین بردن آسیب‌پذیری XXE بر روی برنامه کاربردی وب بنیان راه‌های مختلفی وجود دارد. می‌توانید XXE را در برنامه کاربردی وب بنیان غیرفعال نمایید. اگر هم امکان این کار را ندارید و این کار منجر به مختل کردن عملکرد برنامه کاربردی وب بنیان می‌گردد، بایستی به سراغ تک تک پارسرها رفته و این موضوع  را بررسی نموده و اگر غیرفعال کردن XXE در آن پارسر به عملکرد برنامه کاربردی وب بنیان آسیبی نمی‌رساند این کار را انجام دهید. ویژگی دیگری که می‌توانید غیرفعال کنید DTD می‌باشد، این کار را بهتر است در تمامی قسمت‌های برنامه کاربردی انجام دهید در غیر این صورت به سراغ تک تک پارسرها رفته و در صورتی که غیرفعال کردن این ویژگی آسیبی به عملکرد برنامه نزند آن را غیرفعال کنید.
* ارزیابی ورودی‌های XML نیز یکی دیگر از راهکارهای موثر است. در این صورت قبل از بارگذاری هر payload المان‌های آن بررسی شده و از عدم مخرب بودن آن اطمینان حاصل می‌گردد. به طور مثال برخی برنامه‌های کاربردی وب بنیان به کاربران اجازه می‌دهند تا فایل بارگذاری نمایند. برخی از فرمت‌های رایج بر مبنا XML هستند مثلا تصایر با فرمت‌های SVG و اسناد آفیس با فرمت XML. پس این فایل‌ها می‌توانند ابزار مناسبی برای راه اندازی حملات XXE باشند و بایستی در سمت سرور ارزیابی درستی بر روی آن‌ها انجام پذیرد و در غیر این صورت این برنامه کاربردی وب بنیان آسیب‌پذیر خواهد بود.
* تحلیل کد منبع نیز در اکثر موارد منجر به یافتن این آسیب‌پذیری و برطرف کردن آن می‌گردد. راهکار بعدی استفاده از DAST (ِDynamic Application Security Testing) می‌باشد، در این روش با ارسال XXEهای مختلف آسیب‌پذیری و یا عدم آسیب پذیری برنامه مورد نظر را بررسی نمایید. بسیاری از برنامه‌های کاربردی از یک محتوی پیش فرض که توسط فرم‌های HTML تولید می‌شود مانند application/x-www-form-urlencoded استفاده می‌کنند. اما برخی وب سایت‌ها درخواست‌هایی که نوع محتوی دیگری دارند مثل XML را می‌پذیرند. یکی از بررسی‌های پویای امنیتی که بر روی یک برنامه کاربردی وب بنیان می‌تواند صورت پذیرد نیز همین است که بررسی کنیم آیا محتوی XML را می‌پذیرد و یا خیر! به تکه کد زیر دقت نمایید. این یک نمونه درخواست طبیعی می‌باشد:
```url
POST /action HTTP/1.0 Content-Type: application/x-www-form-urlencoded Content-Length: 7 foo=bar مهاجم قادر خواهد بود درخواست زیر را ارسال نمایید: POST /action HTTP/1.0 Content-Type: text/xml Content-Length: 52
```
* bar اگر هم امکان بررسی و رفع آسیب‌پذیری در کد را ندارید با راه انداز و پیکربندی مناسب یک WAF می‌توانید تا حدودی از حملات XXE جلوگیری نمایید
